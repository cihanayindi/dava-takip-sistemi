{% extends "base.html" %}
 
{% block title %} Anasayfa {% endblock %}

{% block content %}
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <div class="container-fluid">
        <div class="row">
            <!-- Ana İçerik -->
            <div class="col-md-9 offset-md-3">
                <div class="main-content">
                    <!-- Search Bar ve Sonuçlar Kutusu -->
                    <div class="search-section mt-4">
                        <input type="text" id="searchInput" class="form-control" placeholder="Arama yap..." onkeyup="filterResults()">
                        
                        <!-- Arama Sonuçları Kutusu -->
                        <div id="searchResults" class="border mt-2 p-3" style="max-height: 300px; overflow-y: auto;">
                            <!-- Sonuçlar burada dinamik olarak görünecek -->
                        </div>
                    </div>
                    
                    <!-- DAVA BİLGİLERİ TABLOSU -->
                    <div class="case-table mt-4">
                        <h5>Dava Bilgileri</h5>
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Dava No</th>
                                    <th>Dava Türü</th>
                                    <th>Müvekkil</th>
                                    <th>Dava Durumu</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for case in page_obj %}
                                    <tr>
                                        <td>{{ case.case_number }}</td>
                                        <td>{{ case.case_type }}</td>
                                        <td>{{ case.client }}</td>
                                        <td>{{ case.status }}</td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="4">Dava listesinde dava bulunmamaktadır.</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    <!-- PAGINATION CONTROLS -->
                    <div class="pagination">
                        <span class="page-links">
                            {% if page_obj.has_previous %}
                                <a href="?page=1"><i class="fas fa-angle-double-left"></i></a>
                                <a href="?page={{ page_obj.previous_page_number }}"><i class="fas fa-angle-left"></i></a>
                            {% endif %}

                            <span class="current">
                                Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
                            </span>

                            {% if page_obj.has_next %}
                                <a href="?page={{ page_obj.next_page_number }}"><i class="fas fa-angle-right"></i></a>
                                <a href="?page={{ page_obj.paginator.num_pages }}"><i class="fas fa-angle-double-right"></i></a>
                            {% endif %}
                        </span>
                    </div>

                    <!-- Google Calendar Widget (Now inside main-content) -->
                    <div class="google-calendar-widget mt-4">
                        <h5>Google Takvim Etkinlikleri</h5>
                        <div class="calendar-container">
                            <iframe src="https://calendar.google.com/calendar/embed?src=davatakippaneli%40gmail.com&ctz=Europe%2FIstanbul" 
                                    style="border: 0; width: 100%; height: 600px;" frameborder="0" scrolling="no">
                            </iframe>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        .calendar-container {
            width: 100%;
            margin: 0 auto;
        }
        .google-calendar-widget h5 {
            margin-bottom: 1rem;
        }
    </style>

    <!-- JavaScript -->
    <script>
        function filterResults() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            const resultsDiv = document.getElementById('searchResults');
            resultsDiv.innerHTML = '';  // Eski sonuçları temizle
            
            if (input === '') {
                resultsDiv.style.display = 'none';
                return;
            }

            const filteredResults = data.filter(item => item.toLowerCase().includes(input));

            if (filteredResults.length > 0) {
                resultsDiv.style.display = 'block';
                filteredResults.forEach(item => {
                    const resultItem = document.createElement('div');
                    resultItem.classList.add('result-item');
                    resultItem.textContent = item;
                    resultsDiv.appendChild(resultItem);
                });
            } else {
                resultsDiv.style.display = 'none';
            }
        }
    </script>
{% endblock %}