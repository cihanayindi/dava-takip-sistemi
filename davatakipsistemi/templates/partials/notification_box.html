<!-- Notification Box -->
<div class="notification-box border p-3" style="position: fixed; top: 56px; left: 0; width: 350px; height: calc(100vh - 56px); overflow-y: auto; background-color: #f8f9fa; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);">
    <a href="/notifications" style="font-size: 1.25rem; font-weight: bold; color: #333; text-decoration: none; margin: 0 0 15px; display: block; border-bottom: 1px solid #ddd; padding-bottom: 10px;">Bildirimler</a>

    <ul class="list-group" style="padding: 0;">
        <!-- Notifications will be injected here by JavaScript -->
    </ul>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    function fetchNotifications() {
        $.ajax({
            url: '/api/get_notifications/', 
            method: 'GET',
            success: function(data) {
                const notificationList = $('.list-group');
                notificationList.empty(); // Clear existing notifications

                if (data.length === 0) {
                    notificationList.append('<li class="list-group-item" style="text-align: center; color: #666; font-size: 0.9rem;">Hen√ºz bildirim yok</li>');
                } else {
                    data.forEach(notification => {
                        const listItem = $('<li></li>').addClass('list-group-item d-flex justify-content-between align-items-start')
                            .css({ 
                                'margin-bottom': '8px', 
                                'border-radius': '6px', 
                                'border': 'none', 
                                'padding': '10px 15px', 
                                'font-size': '0.95rem', 
                                'background-color': notification.priority === 3 ? '#ffcccc' :
                                                  notification.priority === 2 ? '#ffe6cc' :
                                                  notification.priority === 1 ? '#ccffcc' : 'transparent' 
                            });
                        
                        // Add the notification message
                        if (notification.url) {
                            listItem.append($('<a></a>').attr('href', notification.url).css({ 'text-decoration': 'underline', 'color': 'inherit', 'font-weight': '500' }).text(notification.message));
                        } else {
                            listItem.append($('<span></span>').css({ 'font-weight': '500' }).text(notification.message));
                        }

                        notificationList.append(listItem);
                    });
                }
            },
            error: function(xhr, status, error) {
                console.error("Error fetching notifications: ", error);
            }
        });
    }

    // Fetch notifications every 60 seconds
    $(document).ready(function() {
        fetchNotifications(); // Check notifications when the page loads
        setInterval(fetchNotifications, 60000); // Continue checking every 60 seconds
    });
    
</script>
